# Telegram ChatBot с Claude API

Семейный Telegram бот с интеграцией Claude API, построенный на Go с использованием чистой архитектуры.

## Возможности

- **Ограниченный доступ**: работает только в одной указанной группе
- **Управление сессиями**: контекст сохраняется только во время активной сессии
- **Команды управления**:
  - `/start` - полный перезапуск бота
  - `/startChat` - начать/перезапустить сессию
  - `/endChat` - завершить сессию
  - `/whoami` - информация о пользователе и группе
- **Умное управление контекстом**: автоматическая очистка при превышении лимита
- **Экономичное использование API**: используется Claude 3.5 Sonnet

## Архитектура

Проект использует:
- **Чистую архитектуру** (Clean Architecture)
- **CQRS** паттерн для разделения команд и запросов
- **Dependency Injection** через Wire
- **Структурированное логирование** с Zap

## Быстрый старт

1. Клонируй репозиторий
2. Скопируй `.env.example` в `.env` и заполни переменные:
   ```bash
   TELEGRAM_BOT_TOKEN=your_bot_token
   CLAUDE_API_KEY=your_claude_api_key
   ALLOWED_CHAT_ID=your_chat_id
   ```
3. Запусти:
   ```bash
   make run
   ```

## Docker

```bash
make docker-build
make docker-run
```

## Развертывание

Рекомендуемые бесплатные платформы:
- **Railway** - простое развертывание из GitHub
- **Render** - бесплатный tier с автодеплоем
- **Fly.io** - бесплатный tier для small apps

Для Railway:
1. Подключи GitHub репозиторий
2. Добавь переменные окружения
3. Railway автоматически определит Dockerfile и задеплоит

## Структура проекта

```
├── cmd/main.go              # Точка входа
├── internal/
│   ├── app/                 # Слой приложения
│   ├── config/              # Конфигурация
│   ├── domain/              # Бизнес-логика
│   │   ├── entities/        # Сущности
│   │   ├── commands/        # Команды
│   │   ├── queries/         # Запросы
│   │   └── repositories/    # Интерфейсы репозиториев
│   ├── application/         # Обработчики команд
│   ├── infrastructure/      # Внешние сервисы
│   └── di/                  # Dependency injection
├── Dockerfile
└── docker-compose.yml
```

## API Documentation

После запуска сервиса документация доступна по адресу `http://localhost:8080/docs`.
